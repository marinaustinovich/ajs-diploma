# Диплом "Advanced JavaScript". Retro Game

[![Build status](https://ci.appveyor.com/api/projects/status/fj4hokcn7546il3y/branch/master?svg=true)](https://ci.appveyor.com/project/marinaustinovich/ajs-diploma/branch/master)

deployment: https://marinaustinovich.github.io/ajs-diploma/
## Концепция игры

Двухмерная игра в стиле фэнтези, где игроку предстоит выставлять своих персонажей против 
персонажей нечисти. После каждого раунда восстанавливается жизнь уцелевших персонажей 
игрока и повышается их уровень. Максимальный уровень - 4.

Игру можно сохранять и восстанавливать из сохранения.

Размер поля фиксирован (8x8)

### Классы персонажей

У игрока и соперника в команде могут быть только определённые классы персонажей

#### Классы игрока

1. Bowman (Лучник)
2. Swordsman (Мечник)
3. Magician (Маг)

#### Классы соперника

4. Vampire (Вампир)
5. Undead (Восставший из мёртвых)
6. Daemon (Демон)

##### Описание свойств персонажа:

1. level - его уровень, от 1 до 4
2. attack - показатель атаки
3. defence - показатель защиты
4. health - здоровье персонажа
4. type - строка с одним из допустимых значений:
   *'swordsman'*, *'bowman'*, *'magician'*, *'daemon'*, *'undead'*, *'vampire'*. 

   К этим значениям привязаны изображения персонажей на поле.

Укажите начальные характеристики каждого класса:

| Класс     | attack | defence |
|-----------|--------|---------|
| Bowman    | 25     | 25      |
| Swordsman | 40     | 10      |
| Magician  | 10     | 40      |
| Vampire   | 25     | 25      |
| Undead    | 40     | 10      |
| Daemon    | 10     | 10      |


В игре с каждым новым уровнем у персонажей увеличиваются показатели здоровья, атаки и защиты. 


### Отрисовка команд персонажей

Персонажи генерируются случайным образом в столбцах 1 и 2 для игрока и в столбцах 7 и 8 для соперника:

![](https://i.imgur.com/XqcV1uW.jpg)

**Важно! На поле в одной клетке не могут одновременно находиться два персонажа!**

## 4. Выбор персонажа

**Важно: в новой игре игрок всегда начинает первым**
**Важно: выделить можно только одного персонажа!**

## 5. Ход игрока

Если персонаж игрока выбран, то дальнейшие возможные действия могут быть:
1. Выбрать другого персонажа 
2. Перейти на другую клетку (в рамках допустимых переходов)
3. Атаковать противника (в рамках допустимого радиуса атаки)
4. Недопустимое действие (наведение на ячейку, не попадающую под первые три варианта)

1. Если мы собираемся выбрать другого персонажа, то поле не подсвечивается, а курсор приобретает форму `pointer` 

    ![](https://i.imgur.com/yNI25eV.png)

2. Если мы собираемся перейти на другую клетку (в рамках допустимых переходов), то поле подсвечивается зелёным, курсор приобретает форму `pointer`:

    ![](https://i.imgur.com/Je5zqN0.png)

3. Если мы собираемся атаковать противника (в рамках допустимого радиуса атаки), то поле подсвечивается красным, курсор приобретает форму `crosshair`:

    ![](https://i.imgur.com/gUlSc6O.png)

4. Если мы собираемся выполнить недопустимое действие, то курсор приобретает форму `notallowed` (в этом случае при клике так же выводится сообщение об ошибке):

    ![](https://i.imgur.com/O8QsL40.png)

### Особенности атаки и движения персонажей

Направление движения аналогично ферзю в шахматах. 
Персонажи разного типа могут ходить на разное расстояние 
(в базовом варианте можно перескакивать через других персонажей, т.е. как конь в шахматах, 
единственное правило - ходим по прямым и по диагонали):

* Мечники/Скелеты - 4 клетки в любом направлении
* Лучники/Вампиры - 2 клетки в любом направлении
* Маги/Демоны - 1 клетка в любом направлении

![](https://i.imgur.com/yp8vjhL.jpg)

Дальность атаки тоже ограничена:
* Мечники/Скелеты - могут атаковать только соседнюю клетку
* Лучники/Вампиры - на ближайшие 2 клетки
* Маги/Демоны - на ближайшие 4 клетки

Клетки считаются "по радиусу", допустим для мечника зона поражения будет выглядеть вот так:

![](https://i.imgur.com/gJ8DXPU.jpg)

Для лучника(отмечено красным):

![](https://i.imgur.com/rIINaFD.png)

## 6. Перемещение

Перемещение: Выбирается свободное поле, на которое можно передвинуть персонажа (для этого на поле необходимо кликнуть левой кнопкой мыши)

## 7. Атака

Урон рассчитывается по формуле: `Math.max(attacker.attack - target.defence, attacker.attack * 0.1)`, 
где `attacker` - атакующий персонаж, `target` - атакованный персонаж

При совершении атаки уменьшается здоровье атакованного персонажа на размер урона.

## 8. Ответные действия компьютера

Игрок и компьютер последовательно выполняют по одному игровому действию, после чего управление передаётся противостоящей стороне. 

## 9. Смерть, повышение уровня персонажей

1. Персонажи исчезают после смерти (поле освобождается)
2. В случае, если у противника не осталось персонажей:
   1. Повышается уровень персонажа
   2. Начинается игра на новом уровне

### Повышение уровня персонажа

1. Показатель health приводится к значению: текущий уровень + 80 (но не более 100). 

    Т.е. если у персонажа 1 после окончания раунда уровень жизни был 10, а персонажа 2 - 80, то после levelup:
    - персонаж 1 - жизнь станет 90
    - персонаж 2 - жизнь станет 100

2. Повышение показателей атаки/защиты привязаны к оставшейся жизни по формуле: 

    `attackAfter = Math.max(attackBefore, attackBefore * (80 + life) / 100)`, т.е. если у персонажа после окончания раунда жизни осталось 50%, то его показатели улучшатся на 30%. Если  жизни осталось 1%, то показатели никак не увеличатся.
